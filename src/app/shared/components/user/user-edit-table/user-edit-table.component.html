<div style="width: 80%; margin: 0 auto" class="mat-elevation-z8">
  <table mat-table class="full-width-table" matSort aria-label="Elements">
    <ng-container matColumnDef="fullName">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Full Name</th>
      <td mat-cell *matCellDef="let row">{{ row.fullName }}</td>
    </ng-container>

    <ng-container matColumnDef="username">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Username</th>
      <td mat-cell *matCellDef="let row">{{ row.username }}</td>
    </ng-container>

    <ng-container matColumnDef="editRoles">
      <th mat-header-cell *matHeaderCellDef mat-header>Edit Roles</th>
      <td mat-cell *matCellDef="let row">
        <div *ngIf="userIdToEditRoles != row._id">
          <button
            style="margin-right: 5px"
            (click)="
              userIdToEditRoles = row._id;
              editRolesForm.get('roles')!.setValue(getRoleNameList(row.roles))
            "
            fxFlex="10"
            mat-mini-fab
            color="primary"
          >
            <mat-icon>edit</mat-icon>
          </button>
          {{ getRoleNamesString(row.roles) }}
        </div>

        <form
          *ngIf="userIdToEditRoles == row._id"
          [formGroup]="editRolesForm"
          (ngSubmit)="editRole(row._id)"
        >
          <mat-form-field style="padding-top: 1.25em">
            <mat-label>Roles</mat-label>
            <mat-select formControlName="roles" multiple>
              <mat-option *ngFor="let role of roleNamesData" [value]="role">{{
                role
              }}</mat-option>
            </mat-select>
          </mat-form-field>
          <button
            style="margin-left: 5px"
            type="submit"
            mat-mini-fab
            color="accent"
          >
            <mat-icon>done</mat-icon>
          </button>
        </form>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>

  <mat-paginator
    #paginator
    [length]="dataSource?.data?.length"
    [pageIndex]="0"
    [pageSize]="10"
    [pageSizeOptions]="[5, 10, 20]"
    aria-label="Select page"
  >
  </mat-paginator>
</div>
